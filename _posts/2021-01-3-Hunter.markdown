--- 
layout: post
title: حل تحدي  Hunter من منصة Cyberdefenders 
---

![](https://isolutions.com.ua/wp-content/uploads/2020/04/DigitalForensics.png)
السلام عليكم ورحمة الله وبركاته 
عدنا والعود أحمدٌ 

 

## عناصر المقالة 

- مقدمة 
- أدوات مستخدمة 
- الأسئلة 
- الحل 


## مقدمة 

هذه المقالة ستكون مخصصة لحل تحدي  Hunter من منصة cyberdefenders.org 
التحدي عبارة عن 30 سوال للاجابة على هذه الأسئلة يتطلب منا تحليل كامل ل Windows Image  
ب البداية نستعين ب أداة AccessData_FTK_Imager لفتح image  والبدء ب استخراج Artifacts 

## الأدوات المستخدمة 

## الأسئلة 
1. What is the computer name of the suspect machine
2. What is the computer IP
3. What was the DHCP LeaseObtainedTime
4. How many times did this user log on to the computer
5. What is the computer SID
6. What is the Operating System(OS) version
7. When was the last login time for the discovered account?
8. There was a “Network Scanner” running on this computer, what was it? And when was the last time the suspect used it
9. When did the port scan start and end 
10. How many ports were scanned	
11. What ports were found "open"
12. The employee engaged in a Skype conversation with someone. What is the skype username of the other party



## الحل 
من السؤال الأول حتى السؤال الثامن سوف نجد الأجوبة من خلال  تحليل ملفات Windows Registry (سجل النظام)  
ب الاستعانة ب أداة  `(Registry Explorer )` و أداة `(Reg Ripper)`
من خلال تحليل Image  بإستخدام FTK Imager  سوف نجد ملفات Windows Registry ب المسارين 
`(%Windir%\System32\Config)` و `(%UserProfile%\)`

1- يمكننا استخراج اسم الكمبيوتر من خلال  البحث ب هذا المسار   
`(HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\ComputerName\ComputerName)`

لنجد الإجابة كما هو موضح بالصورة  `4ORENSICS`
![](https://i.ibb.co/hWLn0B8/q1.png)

2-  لحل هذا السؤال يمكننا ايضًا أن نستعين ب Windows Registry (سجل النظام)  
هذه المرة سوف نبحث بهذا المسار 
`(HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Tcpip\Parameters\Interfaces\{***********})`

![](https://i.ibb.co/PW0wVgk/Q2.png)

3-  لحل هذه السؤال هذه المرة  أيضًا سنجد الإجابة في هذا المسار 
`(HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Tcpip\Parameters\Interfaces\{****************})`
![](https://i.ibb.co/LPDQ6CJ/Q3.png)

نجد الإجابة 
`(1466475852)`
ومن ثم نستعين ب

 https://www.epochconverter.com/ 
للتحويل ل قيمة مقرؤة 

![](https://i.ibb.co/mR95B30/q3-con.png)


4- لحل هذا السؤال سوف أقوم بالاستعانة بأداة `(Reg Ripper)`  
وسوف نقوم تحليل مفتاح SAM  تحديدًا 
![](https://i.ibb.co/kmsVjcB/q4-reg.png)

لنجد الإجابة عدد مرات الدخول 3 مرات 

![](https://i.ibb.co/kgPYYwr/q4.png)

5- نستطيع استخراج computer SID من خلال البحث في مسار 
`(HKEY_LOCAL_MACHINESAM\SAM\Domains\Account)`

![](https://i.ibb.co/4gfYbb8/Q5.png)

هنا سوف نجد قيمتين F و V 
يهمنا في هذه الحالة قيمة V  

نقوم ب أخذ اخر 96 بت

2E-D9-61-94-33-5A-2B-A4-80-82-5C-2A
 ثم نقوم بحساب SID  بإتباع الخطوات التالية 


أولًا: نقوم بتقسيمها الى 3 أجزاء

2E-D9-61-94 33-5A-2B-A4 80-82-5C-2A


ثانيًا: نقوم بترتيب البايت بالعكس ل كل قسم

`(2E-D9-61-94  >> 94-61-D9-2E )`

`(33-5A-2B-A4 >> A4-2B-5A-33 )`

`(80-82-5C-2A >> 2A-5C-82-80 )`

`(94,61,D9,2E-A4,2B,5A,33-2A,5C,82,80 )`


ثالثًا: نقوم بتحويل كل قسم الى نظام العد العشري (decimal)

`(2489440558-2754304563-710705792)`

ثم نقوم بإضافة machine SID prefix

`(S-1-5-21-2489440558-2754304563-710705792)`


6- نجد هذه الإجابة في هذا المسار 
`(HKEY_LOCAL_MACHINESAM\SOFTWARE\Microsoft\Windows NT\CurrentVersion)`

![](https://i.ibb.co/kKNTjZh/q6.png)

7- لحل هذا السؤال سوف أقوم بالاستعانة بأداة `(Reg Ripper)`  
وسوف نقوم تحليل مفتاح SAM  تحديدًا 
![](https://i.ibb.co/zQtYVRw/q8.png)

8- لحل هذا السؤال استعنت ب 
ملفات `(Prefetch)`  حيث قمت بالبداية باستخراجها من 
مجلد `(windows/Prefetch)` باستخدام أداة `(FTK Imager)` ومن ثم استعنت بأداة `(winprefetchview)` للتحليل 
لنجد أن الإجابة  `(zenmap.exe)`

![](https://i.ibb.co/tDGwnNx/q9.png)



9- من المعروف أن أداة التقرير الناتج عن أداة  `(zenmap)` سوف نجد وقت بدء عملية المسح و كم المدة المستغرقة في البحث. 
 وعند البحث في ملفات المستخدم `(Hunter)` تحديدًا في `(Desktop)` 
نجد ملف بإسم `(nmapscan.xml)` 
نقوم بإستخراج الملف لقراءة محتواة 
![](https://i.ibb.co/jZR8pFx/q10.png)

سوف نجد وقت بدء عملية المسح المدة المستغرقة و وقت انتهاء عملية المسح 

وقت البدء: 
![](https://i.ibb.co/ypKjqVv/Q10-1.png)

وقت الإنتهاء:
![](https://i.ibb.co/ypKjqVv/Q10-1.png)

10- في نفس الملف المذكور ب السؤال السابق سنجد كم `(Ports)` تم مسحة 
![](https://i.ibb.co/7JkQxT7/q11.png)

11- أيضا بنفس الملف سوف نجد  كم `(Ports)` تم  ايجادة في حالة `(Open)` 
![](https://i.ibb.co/ZRrcHPT/q12.png)
 
12- لحل هذا السؤال قمت بالاستعانة بأداة `(skyperious)`
لكن قبل ذلك قمت ب إستخراج ملف `(skype)` 
من `(users\hunter\AppData\Roaming)` 
![](https://i.ibb.co/CW9xT08/q13-1.png)


ومن ثم  قمت بفتح ملفات `(skype database)` ب استخدام أداة `(skyperious)`
![](https://i.ibb.co/Cbvn3fL/Q13.png)

لتكون الإجابة على هذا السؤال `(linux rul3z)` 





![]()
`(skyperious)`
